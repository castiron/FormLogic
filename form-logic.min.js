(function(){var l;l=function(){};var j=function(a){var b,d,c;this.$el=a;this.$el.hide();this.parentName=this.$el.data("depends-on");this.parents=[];c=$('[name="'+this.parentName+'"]:not([type="hidden"])');b=0;for(d=c.length;b<d;b++)a=c[b],$(a).is('[type="checkbox"]')?this.parentType="checkbox":$(a).is('[type="radio"]')&&(this.parentType="radio"),this.parents.push($(a));this.$el.data("show-if")?this.setupShowIf():this.$el.data("show-if-any")&&this.setupShowIfAny()};j.prototype.setupShowIf=function(){var a,
b,d,c,f,e,g;d=this.$el.data("show-if").toString().split(";");d=d.map(function(a){return a.trim()});b=this;e=this.parents;g=[];c=0;for(f=e.length;c<f;c++)a=e[c],g.push(a.change(function(){var a,c,f,e;console.log("changing "+$(this).attr("name"));if("checkbox"===b.parentType||"radio"===b.parentType){e=b.parents;c=0;for(f=e.length;c<f;c++)if(a=e[c],a.is(":checked")&&-1!==d.indexOf(a.val())){b.show();return}return b.hide()}return-1!==d.indexOf($(this).val())?b.show():b.hide()}).change());return g};j.prototype.setupShowIfAny=
function(){var a,b,d,c,f,e,g=this;if("radio"===this.parentType||"checkbox"===this.parentType){b=this;f=this.parents;e=[];d=0;for(c=f.length;d<c;d++)a=f[d],e.push(a.change(function(){var d,c,f,e;d=!1;e=b.parents;c=0;for(f=e.length;c<f;c++)a=e[c],a.is(":checked")&&(d=!0);return d?b.show():b.hide()}));return e}f=this.parents;e=[];d=0;for(c=f.length;d<c;d++)a=f[d],e.push(a.change(function(){return""!==a.val()?g.show():g.hide()}));return e};j.prototype.show=function(){var a,b,d,c,f,e;console.log("showing");
this.$el.show().data("ignore-validation",!1);f=this.$el.find("*");e=[];d=0;for(c=f.length;d<c;d++)a=f[d],(b=$(a).attr("name"))?(b=$('[data-depends-on="'+b+'"]'),0<b.length?e.push($(a).change()):e.push(void 0)):e.push(void 0);return e};j.prototype.hide=function(){var a,b,d,c,f;console.log("hiding");this.$el.data("ignore-validation",!0).hide();c=this.$el.find("*");f=[];b=0;for(d=c.length;b<d;b++)a=c[b],(a=$(a).attr("name"))?f.push($('[data-depends-on="'+a+'"]').data("ignore-validation",!0).hide()):
f.push(void 0);return f};var h=function(a,b){var d,c,f,e,g=this;this.options=b;this.$el=$(a);this.$submit=this.$el.find('input[type="submit"]');e=this.$el.find("input");c=0;for(f=e.length;c<f;c++)d=e[c],this.addHint($(d));this.$submit.click(function(){var a,b,c,f,e,h,j,k;h=g.$el.find(".hasError");b=0;for(e=h.length;b<e;b++)a=h[b],$(a).removeClass(".hasError");h=g.$el.find(".error");b=0;for(e=h.length;b<e;b++)a=h[b],$(a).html("");b=g.$el.find("input");e=0;for(h=b.length;e<h;e++)if(d=b[e],a=$(d),"submit"===
a.attr("type"))g.$submit=a;else if(a.hasClass("has-hint")&&a.val(""),!a.data("ignore-validation")&&(c=a.data("validate"),"string"===typeof c)){f=c.split(" ");k=0;for(j=f.length;k<j;k++)switch(c=f[k],c){case "required":g.validateRequired(a);break;case "email":g.validateEmail(a);break;case "minimum":g.validateMinimum(a);break;case "maximum":g.validateMaximum(a);break;case "number":g.validateNumber(a);break;case "confirm":g.validateConfirm(a)}}if(g.isValid()&&null!=l.onValidSubmit)return l.onValidSubmit();
if(!g.isValid()){e=g.$el.find("input");b=0;for(a=e.length;b<a;b++)d=e[b],g.addHint($(d));return!1}return!0})};h.prototype.validateRequired=function(a){if(""===a.val())return this.showError(a,"required")};h.prototype.validateEmail=function(a){var b;if(""!==a.val()&&(b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,b=b.test(a.val()),!b))return this.showError(a,"email")};h.prototype.validateMinimum=
function(a){var b,d;if(""!==a.val()&&(b=parseInt(a.data("minimum")),d=parseInt(a.val()),d<b))return this.showError(a,"minimum")};h.prototype.validateMaximum=function(a){var b,d;if(""!==a.val()&&(b=parseInt(a.data("maximum")),d=parseInt(a.val()),d>b))return this.showError(a,"maximum")};h.prototype.validateNumber=function(a){var b;if(""!==a.val()&&(b=a.val(),isNaN(parseFloat(b))||!isFinite(b)))return this.showError(a,"number")};h.prototype.validateConfirm=function(a){var b,d;if(""!==a.val()&&(b=a.data("confirm-target"),
d=a.val(),b=$(b).val(),d!==b))return this.showError(a,"confirm")};h.prototype.showError=function(a,b){var d,c,f,e;this.isValid(!1);a.addClass("has-error");c=a.data("error-target");"undefined"!==typeof c?d=this.$el.find(c):(c=a.next(),"undefined"!==typeof c&&c.hasClass("error")&&(d=c));"undefined"!==typeof d&&(c=a.data("message-"+b),"undefined"===typeof c?(c=a.data("message"),d.html('<div class="error-msg">'+c+"</div>")):d.append('<div class="error-msg">'+c+"</div>"));e=this;f=function(){$(this).removeClass("has-error");
"undefined"!==typeof d&&d.html("");$(this).unbind("focus",f);return e.reset()};return a.focus(f)};h.prototype.addHint=function(a){var b,d,c,f;if(""===a.val()&&(c=a.data("hint"),"undefined"!==typeof c))return a.addClass("has-hint"),a.val(c),f=this,d=function(){$(this).val("");a.removeClass("has-hint");return $(this).unbind("focus",d)},b=function(){if(""===$(this).val())return $(this).unbind("blur",b),f.addHint($(this))},a.focus(d),a.blur(b)};h.prototype.isValid=function(a){"undefined"===typeof this.valid&&
(this.valid=!0);null!=a&&!1===a&&(this.valid=!1);return this.valid};h.prototype.reset=function(){return this.valid=!0};$(function(){var a,b,d,c,f;$("form").each(function(){if($(this).find("[data-validate]"))return new h($(this))});c=$("[data-depends-on]");f=[];b=0;for(d=c.length;b<d;b++)a=c[b],f.push(new j($(a)));return f})}).call(this);